"use strict";(self["webpackChunkvue_manage"]=self["webpackChunkvue_manage"]||[]).push([[169],{2537:function(e,t,a){a.d(t,{Z:function(){return d}});var o=function(){var e=this,t=e._self._c;return t("el-form",{ref:"form",attrs:{"label-width":e.width||"100px",model:e.form_data,inline:e.inline,rules:e.rules}},[e._l(e.form_config,(function(a){return t("el-form-item",{key:a.lable,attrs:{label:a.label}},["input"===a.type?t("el-input",{attrs:{placeholder:"请输入"+a.label},model:{value:e.form_data[a.model],callback:function(t){e.$set(e.form_data,a.model,t)},expression:"form_data[item.model]"}}):e._e(),"switch"===a.type?t("el-switch",{model:{value:e.form_data[a.model],callback:function(t){e.$set(e.form_data,a.model,t)},expression:"form_data[item.model]"}}):e._e(),"date"===a.type?t("el-date-picker",{attrs:{placeholder:"请选择日期",type:"date","value-format":"yyyy-MM-dd"},model:{value:e.form_data[a.model],callback:function(t){e.$set(e.form_data,a.model,t)},expression:"form_data[item.model]"}}):e._e(),"select"===a.type?t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form_data[a.model],callback:function(t){e.$set(e.form_data,a.model,t)},expression:"form_data[item.model]"}},e._l(a.opts,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):e._e()],1)})),t("el-form-item",[e._t("default")],2)],2)},n=[],r={name:"CommonForm",props:{formConfig:Array,formData:Object,inline:Boolean,rules:Object,width:String},data(){return{form_config:this.formConfig,form_data:this.formData}}},l=r,i=a(1001),s=(0,i.Z)(l,o,n,!1,null,null,null),d=s.exports},5169:function(e,t,a){a.r(t),a.d(t,{default:function(){return b}});var o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"manage"},[e.isShow?t("div",[t("el-dialog",{attrs:{title:"add"===e.operateType?"添加用户":"编辑用户",visible:e.isShow},on:{"update:visible":function(t){e.isShow=t}}},[t("common-form",{ref:"form",attrs:{formConfig:e.formConfig,formData:e.formData,inline:!0}}),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.isShow=!1,e.isChange=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确 定")])],1)],1)],1):e._e(),t("div",{staticClass:"manage-header"},[t("el-button",{attrs:{type:"primary"},on:{click:e.addUser}},[e._v("+ 新增")]),t("common-form",{ref:"form",attrs:{formConfig:e.searchFormConfig,formData:e.searchFormData,inline:!0}},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.getList(e.searchFormData.keyword)}}},[e._v("搜索")])],1)],1),t("common-table",{attrs:{tableConfig:e.tableConfig,tableData:e.tableData,pageConfig:e.pageConfig},on:{edit:e.editUser,del:e.delUser,changePage:function(t){return e.getList()}}})],1)},n=[],r=a(2537),l=function(){var e=this,t=e._self._c;return t("div",{staticClass:"common-table"},[t("el-table",{attrs:{data:e.table_data,height:"93%"}},[e._l(e.table_config,(function(a){return t("el-table-column",{key:a.label,attrs:{"show-overflow-tooltip":"",label:a.label,width:a.width?a.width:150},scopedSlots:e._u([{key:"default",fn:function(o){return[t("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(o.row[a.prop]))])]}}],null,!0)})})),t("el-table-column",{attrs:{label:"操作","min-width":"180"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.handleEdit(a.row)}}},[e._v("编辑")]),t("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleDelete(a.row)}}},[e._v("删除")])]}}])})],2),t("el-pagination",{staticClass:"pager",attrs:{layout:"prev, pager, next",background:"",total:e.page_config.total,"current-page":e.page_config.page},on:{"update:currentPage":function(t){return e.$set(e.page_config,"page",t)},"update:current-page":function(t){return e.$set(e.page_config,"page",t)},"current-change":e.changePage}})],1)},i=[],s={name:"CommonTable",props:{tableConfig:Array,tableData:Array,pageConfig:Object},data(){return{table_config:this.tableConfig,table_data:this.tableData,page_config:this.pageConfig}},methods:{handleEdit(e){this.$emit("edit",e)},handleDelete(e){this.$emit("del",e)},changePage(e){this.$emit("changePage",e)}},watch:{tableData(e){this.table_data=e},pageConfig(e){this.page_config=e}}},d=s,c=a(1001),m=(0,c.Z)(d,l,i,!1,null,"88bfe8f2",null),p=m.exports,f=a(23),u={name:"User",components:{CommonForm:r.Z,CommonTable:p},data(){return{operateType:"add",isShow:!1,formConfig:[{label:"工号",type:"input",model:"id"},{label:"姓名",type:"input",model:"name"},{label:"性别",type:"select",model:"gender",opts:[{label:"男",value:"男"},{label:"女",value:"女"}]},{label:"年龄",type:"input",model:"age"},{label:"部门",type:"input",model:"dept"}],formData:{id:"",name:"",gender:"",age:"",dept:""},searchFormConfig:[{label:"",type:"input",model:"keyword"}],searchFormData:{keyword:""},tableConfig:[{prop:"Id",label:"工号"},{prop:"Name",label:"姓名"},{prop:"Gender",label:"性别"},{prop:"Age",label:"年龄"},{prop:"Dept",label:"部门"}],tableData:[],pageConfig:{page:1,total:100}}},methods:{confirm(){if("edit"===this.operateType){const{id:e,name:t,gender:a,age:o,dept:n}=this.formData;(0,f.HG)(e,t,a,o,n).then((e=>{this.isShow=!1;const t=200===e.code?"success":"error";this.getList(),this.$message({type:t,message:e.message})}))}else{const{id:e,name:t,gender:a,age:o,dept:n}=this.formData;(0,f.xk)(e,t,a,o,n).then((e=>{this.isShow=!1;const t=200===e.code?"success":"error";this.getList(),this.$message({type:t,message:e.message})}))}},addUser(){this.operateType="add",this.isShow=!0,this.formData={id:"",name:"",gender:"",age:"",dept:""}},editUser(e){this.operateType="edit",this.isShow=!0,this.formData={...e}},delUser(e){this.$confirm("此操作将永久删除该用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{const t=e.Id;console.log("row",e),console.log("id",t),(0,f.P6)(t).then((()=>{this.$message({type:"success",message:"删除成功!"}),this.getList()}))})).catch((e=>{this.$message({type:"info",message:"已取消删除"}),console.log(e),this.getList()}))},getList(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.pageConfig.loading=!0,this.pageConfig.page=e?1:this.pageConfig.page,(0,f.fN)().then((e=>{this.tableData=e.data,console.log(e.data),this.tableConfig.total=e.data.count,this.tableConfig.loading=!1}))}},created(){this.getList()}},g=u,h=(0,c.Z)(g,o,n,!1,null,"23510dbf",null),b=h.exports},23:function(e,t,a){a.d(t,{HG:function(){return d},P6:function(){return c},cP:function(){return l},fN:function(){return i},xk:function(){return s}});var o=a(6265),n=a.n(o);n().defaults.baseURL="http://localhost:3000/api";let r=null;const l=async(e,t)=>{try{const a=await n().post("/login",{username:e,password:t});return r=a.data.data.token,n().defaults.headers.common["Authorization"]=`Bearer ${r}`,a.data}catch(a){throw console.error("Login error:",a.response.data),a}},i=async()=>{try{const e=localStorage.getItem("token"),t=await n().get("/employees",{headers:{Authorization:`Bearer ${e}`}});return t.data}catch(e){throw console.error("Get employees error:",e.response.data),e}},s=async(e,t,a,o,r)=>{try{const l=await n().post("/employees",{id:e,name:t,gender:a,age:o,dept:r});return l.data}catch(l){throw console.error("Add employee error:",l.response.data),l}},d=async(e,t,a,o,r)=>{try{const l=await n().put(`/employees/${e}`,{name:t,gender:a,age:o,dept:r});return l.data}catch(l){throw console.error("Update employee error:",l.response.data),l}},c=async e=>{try{const t=await n()["delete"](`/employees/${e}`);return t.data}catch(t){throw console.error("Delete employee error:",t.response.data),t}}}}]);
//# sourceMappingURL=169.131ce1c1.js.map